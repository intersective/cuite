(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{cAcB:function(n,e,t){"use strict";t.r(e);var l=t("CcnG"),o=function(){return function(){}}(),r=t("pMnS"),i=t("oBZk"),u=t("ZZ/e"),a=t("BuPC"),c=t("F/XL"),s=t("yrbL"),d=t("67Y/"),p=t("t/Na"),m=t("fbMX"),h=t("kh7C"),f=t("AytR"),g=t("x2vf"),v=function(){function n(n,e,t,l){this.request=n,this.storage=e,this.utils=t,this.demo=l}return n.prototype.directLogin=function(n){if(f.a.demo){var e=this.demo.directLogin();return this._handleLoginResponse(e),Object(c.a)(e).pipe(Object(s.delay)(2e3))}var t=(new p.h).set("auth_token",n);return this.request.post("api/auths.json",t.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).pipe(Object(d.a)(this._handleLoginResponse,this))},n.prototype._handleLoginResponse=function(n){var e=n.data;if(e){this.storage.setUser({apikey:e.apikey,timelineId:e.timeline_id?e.timeline_id:null,programId:e.program_id?e.program_id:null});var t=e.Timelines.map(function(n){return{enrolment:n.Enrolment,program:n.Program,project:n.Project,timeline:n.Timeline}});this.storage.set("programs",t)}return this.getMyInfo().subscribe(),n},n.prototype.getMyInfo=function(){if(f.a.demo){var n=this.demo.getMyInfo();return this._handleMyInfo(n),Object(c.a)(n)}return this.request.get("api/users.json").pipe(Object(d.a)(this._handleMyInfo,this))},n.prototype._handleMyInfo=function(n){if(n.data){if(!this.utils.has(n,"data.User"))return this.request.apiResponseFormatError("User format error");var e=n.data.User;this.storage.setUser({name:e.name,contactNumber:e.contact_number,email:e.email,image:e.image,userHash:e.userhash})}return n},n.ngInjectableDef=l.defineInjectable({factory:function(){return new n(l.inject(a.a),l.inject(m.b),l.inject(h.a),l.inject(g.a))},token:n,providedIn:"root"}),n}(),b=t("9nlD"),y=function(){function n(n,e,t,l){this.router=n,this.route=e,this.authService=t,this.notificationService=l}return n.prototype.ngOnInit=function(){var n=this,e=this.route.snapshot.paramMap.get("token");if(!e)return this._error();this.authService.directLogin(e).subscribe(function(e){n.router.navigate(["/dashboard"])},function(e){n._error()})},n.prototype._error=function(){var n=this;this.notificationService.alert({message:"Your link is invalid or expired.",buttons:[{text:"OK",role:"cancel",handler:function(){n.router.navigate(["/error"])}}]})},n}(),C=t("ZYCi"),_=l["\u0275crt"]({encapsulation:0,styles:[[".logo[_ngcontent-%COMP%]{margin-top:25%;margin-bottom:5%}.logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:20px;display:inline-block;font-size:40px;font-weight:700}.msg[_ngcontent-%COMP%]{margin-left:30%;margin-right:30%}.vertical-middle[_ngcontent-%COMP%]{vertical-align:middle}"]],data:{}});function M(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,12,"ion-content",[["color","light"],["text-center",""]],null,null,null,i.I,i.i)),l["\u0275did"](1,49152,null,0,u.t,[l.ChangeDetectorRef,l.ElementRef],{color:[0,"color"]},null),(n()(),l["\u0275eld"](2,0,null,0,3,"div",[["class","logo"]],null,null,null,null,null)),(n()(),l["\u0275eld"](3,0,null,null,0,"img",[["class","vertical-middle"],["src","./assets/loading.gif"],["width","60px"]],null,null,null,null,null)),(n()(),l["\u0275eld"](4,0,null,null,1,"span",[["class","vertical-middle"]],null,null,null,null,null)),(n()(),l["\u0275ted"](-1,null,["Practera"])),(n()(),l["\u0275eld"](6,0,null,0,6,"div",[["class","msg"]],null,null,null,null,null)),(n()(),l["\u0275eld"](7,0,null,null,5,"ion-card",[],null,null,null,i.F,i.f)),l["\u0275did"](8,49152,null,0,u.l,[l.ChangeDetectorRef,l.ElementRef],null,null),(n()(),l["\u0275eld"](9,0,null,0,3,"p",[],null,null,null,null,null)),(n()(),l["\u0275eld"](10,0,null,null,2,"ion-text",[["color","medium"]],null,null,null,i.W,i.w)),l["\u0275did"](11,49152,null,0,u.vb,[l.ChangeDetectorRef,l.ElementRef],{color:[0,"color"]},null),(n()(),l["\u0275ted"](-1,0,["Please wait while we redirect you to the new Practera ..."]))],function(n,e){n(e,1,0,"light"),n(e,11,0,"medium")},null)}function I(n){return l["\u0275vid"](0,[(n()(),l["\u0275eld"](0,0,null,null,1,"app-auth",[],null,null,null,M,_)),l["\u0275did"](1,114688,null,0,y,[C.n,C.a,v,b.a],null,null)],function(n,e){n(e,1,0)},null)}var R=l["\u0275ccf"]("app-auth",y,I,{},{},[]),w=t("Ip0R"),j=function(){return function(){}}();t.d(e,"AuthModuleNgFactory",function(){return O});var O=l["\u0275cmf"](o,[],function(n){return l["\u0275mod"]([l["\u0275mpd"](512,l.ComponentFactoryResolver,l["\u0275CodegenComponentFactoryResolver"],[[8,[r.a,R]],[3,l.ComponentFactoryResolver],l.NgModuleRef]),l["\u0275mpd"](4608,w.NgLocalization,w.NgLocaleLocalization,[l.LOCALE_ID,[2,w["\u0275angular_packages_common_common_a"]]]),l["\u0275mpd"](4608,u.b,u.b,[l.NgZone,l.ApplicationRef]),l["\u0275mpd"](4608,u.Fb,u.Fb,[u.b,l.ComponentFactoryResolver,l.Injector,w.DOCUMENT]),l["\u0275mpd"](4608,u.Ib,u.Ib,[u.b,l.ComponentFactoryResolver,l.Injector,w.DOCUMENT]),l["\u0275mpd"](1073742336,w.CommonModule,w.CommonModule,[]),l["\u0275mpd"](1073742336,u.Cb,u.Cb,[]),l["\u0275mpd"](1073742336,C.o,C.o,[[2,C.u],[2,C.n]]),l["\u0275mpd"](1073742336,j,j,[]),l["\u0275mpd"](1073742336,o,o,[]),l["\u0275mpd"](1024,C.l,function(){return[[{path:":token",component:y}]]},[])])})}}]);