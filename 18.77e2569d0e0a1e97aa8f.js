(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{cAcB:function(n,e,t){"use strict";t.r(e);var o=t("CcnG"),r=function(){return function(){}}(),l=t("pMnS"),i=t("oBZk"),a=t("ZZ/e"),u=t("BuPC"),s=t("F/XL"),c=t("yrbL"),d=t("67Y/"),p=t("t/Na"),m=t("fbMX"),h=t("kh7C"),f=t("AytR"),g=t("x2vf"),v=function(){function n(n,e,t,o){this.request=n,this.storage=e,this.utils=t,this.demo=o}return n.prototype.directLogin=function(n){if(f.a.demo){var e=this.demo.directLogin();return this._handleLoginResponse(e),Object(s.a)(e).pipe(Object(c.delay)(2e3))}var t=(new p.h).set("auth_token",n);return this.request.post("api/auths.json",t.toString(),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).pipe(Object(d.a)(this._handleLoginResponse,this))},n.prototype._handleLoginResponse=function(n){var e=n.data;if(e){this.storage.setUser({apikey:e.apikey});var t=e.Timelines.map(function(n){return{enrolment:n.Enrolment,program:n.Program,project:n.Project,timeline:n.Timeline}});this.storage.set("programs",t)}return this.getMyInfo().subscribe(),n},n.prototype.getMyInfo=function(){if(f.a.demo){var n=this.demo.getMyInfo();return this._handleMyInfo(n),Object(s.a)(n)}return this.request.get("api/users.json").pipe(Object(d.a)(this._handleMyInfo,this))},n.prototype._handleMyInfo=function(n){if(n.data){if(!this.utils.has(n,"data.User"))return this.request.apiResponseFormatError("User format error");var e=n.data.User;this.storage.setUser({name:e.name,contactNumber:e.contact_number,email:e.email,role:e.role,image:e.image,userHash:e.userhash})}return n},n.ngInjectableDef=o.defineInjectable({factory:function(){return new n(o.inject(u.a),o.inject(m.b),o.inject(h.a),o.inject(g.a))},token:n,providedIn:"root"}),n}(),b=t("mrSG"),y=function(){function n(n,e,t){this.modalController=n,this.alertController=e,this.toastController=t}return n.prototype.dismiss=function(){return this.modalController.dismiss()},n.prototype.modalConfig=function(n,e){return void 0===e&&(e={}),Object.assign({component:n.component,componentProps:n.componentProps},e)},n.prototype.modal=function(n,e,t){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(o){switch(o.label){case 0:return[4,this.modalController.create(this.modalConfig({component:n,componentProps:e},t))];case 1:return[4,o.sent().present()];case 2:return[2,o.sent()]}})})},n.prototype.alert=function(n){return b.__awaiter(this,void 0,void 0,function(){return b.__generator(this,function(e){switch(e.label){case 0:return[4,this.alertController.create(n)];case 1:return[4,e.sent().present()];case 2:return[2,e.sent()]}})})},n.prototype.presentToast=function(n,e,t){return void 0===e&&(e=!0),void 0===t&&(t=2e3),b.__awaiter(this,void 0,void 0,function(){var o;return b.__generator(this,function(r){switch(r.label){case 0:return o="success",e||(o="danger"),[4,this.toastController.create({message:n,duration:t,position:"top",color:o})];case 1:return r.sent().present(),[2]}})})},n.ngInjectableDef=o.defineInjectable({factory:function(){return new n(o.inject(a.Db),o.inject(a.a),o.inject(a.Ib))},token:n,providedIn:"root"}),n}(),C=function(){function n(n,e,t,o){this.router=n,this.route=e,this.authService=t,this.notificationService=o}return n.prototype.ngOnInit=function(){var n=this,e=this.route.snapshot.paramMap.get("token");if(!e)return this._error();this.authService.directLogin(e).subscribe(function(e){n.router.navigate(["dashboard"])},function(e){n._error()})},n.prototype._error=function(){var n=this;this.notificationService.alert({message:"Your link is invalid or expired.",buttons:[{text:"OK",role:"cancel",handler:function(){n.router.navigate(["/auth/error"])}}]})},n}(),_=t("ZYCi"),w=o["\u0275crt"]({encapsulation:0,styles:[[".logo[_ngcontent-%COMP%]{margin-top:25%;margin-bottom:5%}.logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-left:20px;display:inline-block;font-size:40px;font-weight:700}.msg[_ngcontent-%COMP%]{margin-left:30%;margin-right:30%}.vertical-middle[_ngcontent-%COMP%]{vertical-align:middle}"]],data:{}});function j(n){return o["\u0275vid"](0,[(n()(),o["\u0275eld"](0,0,null,null,12,"ion-content",[["color","light"],["text-center",""]],null,null,null,i.u,i.e)),o["\u0275did"](1,49152,null,0,a.s,[o.ChangeDetectorRef,o.ElementRef],{color:[0,"color"]},null),(n()(),o["\u0275eld"](2,0,null,0,3,"div",[["class","logo"]],null,null,null,null,null)),(n()(),o["\u0275eld"](3,0,null,null,0,"img",[["class","vertical-middle"],["src","./assets/loading.gif"],["width","60px"]],null,null,null,null,null)),(n()(),o["\u0275eld"](4,0,null,null,1,"span",[["class","vertical-middle"]],null,null,null,null,null)),(n()(),o["\u0275ted"](-1,null,["Practera"])),(n()(),o["\u0275eld"](6,0,null,0,6,"div",[["class","msg"]],null,null,null,null,null)),(n()(),o["\u0275eld"](7,0,null,null,5,"ion-card",[],null,null,null,i.t,i.d)),o["\u0275did"](8,49152,null,0,a.k,[o.ChangeDetectorRef,o.ElementRef],null,null),(n()(),o["\u0275eld"](9,0,null,0,3,"p",[],null,null,null,null,null)),(n()(),o["\u0275eld"](10,0,null,null,2,"ion-text",[["color","medium"]],null,null,null,i.D,i.n)),o["\u0275did"](11,49152,null,0,a.ub,[o.ChangeDetectorRef,o.ElementRef],{color:[0,"color"]},null),(n()(),o["\u0275ted"](-1,0,["Please wait while we redirect you to the new Practera ..."]))],function(n,e){n(e,1,0,"light"),n(e,11,0,"medium")},null)}function M(n){return o["\u0275vid"](0,[(n()(),o["\u0275eld"](0,0,null,null,1,"app-auth",[],null,null,null,j,w)),o["\u0275did"](1,114688,null,0,C,[_.m,_.a,v,y],null,null)],function(n,e){n(e,1,0)},null)}var R=o["\u0275ccf"]("app-auth",C,M,{},{},[]),I=t("Ip0R"),k=function(){return function(){}}();t.d(e,"AuthModuleNgFactory",function(){return O});var O=o["\u0275cmf"](r,[],function(n){return o["\u0275mod"]([o["\u0275mpd"](512,o.ComponentFactoryResolver,o["\u0275CodegenComponentFactoryResolver"],[[8,[l.a,R]],[3,o.ComponentFactoryResolver],o.NgModuleRef]),o["\u0275mpd"](4608,I.NgLocalization,I.NgLocaleLocalization,[o.LOCALE_ID,[2,I["\u0275angular_packages_common_common_a"]]]),o["\u0275mpd"](4608,a.b,a.b,[o.NgZone,o.ApplicationRef]),o["\u0275mpd"](4608,a.Db,a.Db,[a.b,o.ComponentFactoryResolver,o.Injector,I.DOCUMENT]),o["\u0275mpd"](4608,a.Gb,a.Gb,[a.b,o.ComponentFactoryResolver,o.Injector,I.DOCUMENT]),o["\u0275mpd"](1073742336,I.CommonModule,I.CommonModule,[]),o["\u0275mpd"](1073742336,a.Bb,a.Bb,[]),o["\u0275mpd"](1073742336,_.n,_.n,[[2,_.t],[2,_.m]]),o["\u0275mpd"](1073742336,k,k,[]),o["\u0275mpd"](1073742336,r,r,[]),o["\u0275mpd"](1024,_.k,function(){return[[{path:":token",component:C}]]},[])])})}}]);